(()=>{var e={};e.id=3,e.ids=[3],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5209:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>d,serverHooks:()=>f,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{GET:()=>m});var o=r(9682),n=r(1739),a=r(6442),i=r(9667);let p=new Map,l=new Map;function c(e){let t=p.get(e);return t?Date.now()>t.timestamp+t.ttl?(p.delete(e),null):t.data:null}function u(e,t,r){p.set(e,{data:t,timestamp:Date.now(),ttl:r})}async function m(e){let{searchParams:t}=new URL(e.url),r=t.get("action");if(!function(e,t=60,r=6e4){let s=Date.now(),o=l.get(e);return!o||s>o.resetTime?(l.set(e,{count:1,resetTime:s+r}),!0):!(o.count>=t)&&(o.count++,!0)}(e.headers.get("x-forwarded-for")||e.headers.get("x-real-ip")||"unknown",60,6e4))return i.NextResponse.json({error:"Rate limit exceeded"},{status:429});try{if("block-at-time"===r){let e=t.get("timestamp");if(!e)return i.NextResponse.json({error:"Missing timestamp parameter"},{status:400});let r=`block-at-time-${e}`,s=c(r);if(s)return i.NextResponse.json(s);let o=0,n=null;for(;o<3;)try{let t=await fetch(`https://mempool.space/api/v1/mining/blocks/timestamp/${e}`,{method:"GET",headers:{Accept:"application/json","User-Agent":"Bitcoin-Blocks-Mini-App/1.0"},signal:AbortSignal.timeout(1e4)});if(!t.ok)throw Error(`mempool.space API returned ${t.status}`);let s=await t.json();if(!s||0===s.length)return i.NextResponse.json({error:"No blocks found after the given timestamp"},{status:404});let o=s[0],n={blockHash:o.id,txCount:o.tx_count,timestamp:o.timestamp,height:o.height};return u(r,n,3e5),i.NextResponse.json(n)}catch(e){n=e,++o<3&&await new Promise(e=>setTimeout(e,1e3*o))}return i.NextResponse.json({error:"Failed to fetch block data after multiple attempts",details:n?.message||"Unknown error",status:"pending_result"},{status:503})}if("tx-count"===r){let e=t.get("blockHash");if(!e)return i.NextResponse.json({error:"Missing blockHash parameter"},{status:400});let r=`tx-count-${e}`,s=c(r);if(s)return i.NextResponse.json(s);let o=0,n=null;for(;o<3;)try{let t=await fetch(`https://mempool.space/api/block/${e}/txids`,{method:"GET",headers:{Accept:"application/json","User-Agent":"Bitcoin-Blocks-Mini-App/1.0"},signal:AbortSignal.timeout(1e4)});if(!t.ok)throw Error(`mempool.space API returned ${t.status}`);let s={txCount:(await t.json()).length};return u(r,s,6e5),i.NextResponse.json(s)}catch(e){n=e,++o<3&&await new Promise(e=>setTimeout(e,1e3*o))}return i.NextResponse.json({error:"Failed to fetch transaction count after multiple attempts",details:n?.message||"Unknown error",status:"pending_result"},{status:503})}if("recent-blocks"===r){let e="recent-blocks",t=c(e);if(t)return i.NextResponse.json(t);let r=0,s=null;for(;r<3;)try{let t=await fetch("https://mempool.space/api/blocks",{method:"GET",headers:{Accept:"application/json","User-Agent":"Bitcoin-Blocks-Mini-App/1.0"},signal:AbortSignal.timeout(1e4)});if(!t.ok)throw Error(`mempool.space API returned ${t.status}`);let r=(await t.json()).slice(0,10).map(e=>({height:e.height,hash:e.id,timestamp:e.timestamp,tx_count:e.tx_count,size:e.size}));return u(e,r,3e4),i.NextResponse.json(r)}catch(e){s=e,++r<3&&await new Promise(e=>setTimeout(e,1e3*r))}return i.NextResponse.json({error:"Failed to fetch recent blocks after multiple attempts",details:s?.message||"Unknown error"},{status:503})}if("recent-txs"===r){let e="recent-txs",t=c(e);if(t)return i.NextResponse.json(t);let r=0,s=null;for(;r<3;)try{let t=await fetch("https://mempool.space/api/mempool/recent",{method:"GET",headers:{Accept:"application/json","User-Agent":"Bitcoin-Blocks-Mini-App/1.0"},signal:AbortSignal.timeout(1e4)});if(!t.ok)throw Error(`mempool.space API returned ${t.status}`);let r=(await t.json()).slice(0,5);return u(e,r,1e4),i.NextResponse.json(r)}catch(e){s=e,++r<3&&await new Promise(e=>setTimeout(e,1e3*r))}return i.NextResponse.json({error:"Failed to fetch recent transactions after multiple attempts",details:s?.message||"Unknown error"},{status:503})}return i.NextResponse.json({error:"Invalid action parameter. Use: block-at-time, tx-count, recent-blocks, or recent-txs"},{status:400})}catch(e){return console.error("Mempool API error:",e),i.NextResponse.json({error:"Internal server error",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/mempool/route",pathname:"/api/mempool",filename:"route",bundlePath:"app/api/mempool/route"},resolvedPagePath:"c:\\Users\\UserBQ\\Downloads\\mini app\\blocks\\src\\app\\api\\mempool\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:h,workUnitAsyncStorage:x,serverHooks:f}=d;function g(){return(0,a.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:x})}},7002:()=>{},8850:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[859,176],()=>r(5209));module.exports=s})();